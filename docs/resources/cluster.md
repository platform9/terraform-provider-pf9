---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "pf9_cluster Resource - Platform9 Pf9"
subcategory: ""
description: |-
  
---

# pf9_cluster Resource

This can be used to create, modify, and delete pf9 cluster.

## Example Usage

```terraform
resource "pf9_cluster" "example" {
  name = "example"
  master_nodes = [
    "17f9b392-67bb-43b9-b0b7-3b5821f683a6",
    "7f5aa992-0abe-40a0-9bf9-6a06ebb9ccfd",
    "a17fa56d-722b-4f10-8b50-ffa5a4bed36e"
  ]
  allow_workloads_on_master = false
  worker_nodes = [
    "2bfbc40e-1d72-4bfc-a46b-56b674862cc7",
    "bbbd1c20-3cda-405d-ae4b-d0337fffd6e1"
  ]
  master_vip_ipv4              = "10.149.107.237"
  master_vip_iface             = "ens3"
  containers_cidr              = "10.20.0.0/16"
  services_cidr                = "10.21.0.0/16"
  interface_detection_method   = "InterfaceName"
  interface_name               = "ens3"
  network_plugin               = "calico"
  calico_ipv4_detection_method = "interface=ens3"
  etcd_backup = {
    daily = {
      backup_time = "02:00"
    }
  }
  tags = {
    "key1" = "value1"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `master_nodes` (Set of String) List of uuid of master nodes
- `name` (String) Name of the cluster

### Optional

- `addons` (Attributes Map) (see [below for nested schema](#nestedatt--addons))
- `allow_workloads_on_master` (Boolean) If the master nodes can run non-critical workloads
- `batch_upgrade_percent` (Number) Percentage of nodes to upgrade at a time during a batch upgrade. If this attribute is omitted then nodes will be sequentially upgraded, one after the other.
- `calico_ip_ip_mode` (String) IP-IP encapsulation mode for Calico network. Choose: Always, Never, CrossSubnet
- `calico_ipv4` (String)
- `calico_ipv4_detection_method` (String) Method to detect the IPv4 address
- `calico_ipv6` (String)
- `calico_ipv6_detection_method` (String)
- `calico_ipv6_pool_block_size` (String)
- `calico_ipv6_pool_cidr` (String)
- `calico_ipv6_pool_nat_outgoing` (Boolean)
- `calico_limits` (Attributes) (see [below for nested schema](#nestedatt--calico_limits))
- `calico_nat_outgoing` (Boolean) Field is set to true if Calico nodes need to NAT north-south egress traffic.
- `calico_v4_block_size` (String) Subnet size per node for the Calico network, in CIDR notation (e.g. 26)
- `cert_expiry_hrs` (Number) Number of hours before user certificates in kubeconfig expires, should be greater than 0 if set
- `container_runtime` (String) Container runtime used by this cluster
- `containers_cidr` (String) CIDR used for pod IP addresses, applicable also for manual deploy
- `cpu_manager_policy` (String) options: none, static; default: none
- `custom_registry` (Attributes) (see [below for nested schema](#nestedatt--custom_registry))
- `docker_centos_package_repo_url` (String)
- `docker_private_registry` (String)
- `docker_root` (String)
- `docker_ubuntu_package_repo_url` (String)
- `enable_catapult_monitoring` (Boolean) If set to true platform9 Catapult monitoring will be deployed on the cluster
- `etcd` (Attributes) (see [below for nested schema](#nestedatt--etcd))
- `etcd_backup` (Attributes) (see [below for nested schema](#nestedatt--etcd_backup))
- `external_dns_name` (String) Optional DNS name for API endpoint. This field is autogenerated when usePf9Domain is set, also applicable for manual deploy
- `felix_ipv6_support` (Boolean)
- `flannel_iface_label` (String)
- `flannel_public_iface_label` (String)
- `gcr_private_registry` (String)
- `interface_detection_method` (String) Method to detect the interface
- `interface_name` (String) Name of the interface
- `interface_reachable_ip` (String)
- `ipv6` (Boolean) Enable IPv6 for the cluster
- `k8s_api_port` (Number) Port on which the Kubernetes API server is running
- `k8s_config` (Attributes) (see [below for nested schema](#nestedatt--k8s_config))
- `k8s_private_registry` (String)
- `kube_role_version` (String) kube role version to be used when bringing up the cluster.
- `master_vip_iface` (String) If master_vip_ipv4 is specified, this field is required. Specify the interface that the VIP attaches to
- `master_vip_ipv4` (String) API server Virtual IP that provides failover. When specified, deploy keepalived setup to cluster master nodes together
- `mtu_size` (Number) MTU for container network interfaces. Optional and used for the Calico network backend
- `network_plugin` (String) Network backend to use for container networking. Defaults to flannel. Supported choices are flannel, calico
- `node_pool_uuid` (String) Optional. UUID of the node pool used for the cluster. Defaults to the first node pool of the local cloud provider type
- `privileged` (Boolean) True if cluster runs privileged containers
- `quay_private_registry` (String)
- `reserved_cpus` (String) Enter a comma separated list of CPUs to be reserved for the system,example:4-8,9-12
- `services_cidr` (String) CIDR used for service IP addresses, applicable also for manual deploy
- `tags` (Map of String) User defined key-value pairs represented as a JSON object
- `topology_manager_policy` (String) options: none, best-effort, restricted, single-numa-node; default: none
- `use_hostname` (Boolean) If set to true nodes will be registered in the cluster using hostname instead of IP address. This option is only applicable to IPv4 hosts.
- `worker_nodes` (Set of String) List of uuid of worker nodes. Required if allow_workloads_on_master is false

### Read-Only

- `calico_router_id` (String)
- `cloud_provider` (Attributes) (see [below for nested schema](#nestedatt--cloud_provider))
- `created_at` (String) Time at which the cluster was created
- `id` (String) UUID of the cluster
- `master_ip` (String) IP of master node
- `master_vip_vrouter_id` (String) Virtual router ID of the master VIP
- `masterless` (Boolean) Field is set to true if the cluster is masterless
- `node_pool_name` (String)
- `project_id` (String)
- `status` (Attributes) (see [below for nested schema](#nestedatt--status))
- `upgrade_kube_role_version` (String) kube role version to which the cluster can be upgraded.

<a id="nestedatt--addons"></a>
### Nested Schema for `addons`

Optional:

- `params` (Map of String)
- `version` (String)

Read-Only:

- `phase` (String)


<a id="nestedatt--calico_limits"></a>
### Nested Schema for `calico_limits`

Optional:

- `controller_cpu_limit` (String) Corresponds to the CALICO_CONTROLLER_CPU_LIMIT environment variable in Calico.
- `controller_memory_limit` (String) Corresponds to the CALICO_CONTROLLER_MEMORY_LIMIT environment variable in Calico.
- `node_cpu_limit` (String) Corresponds to the CALICO_NODE_CPU_LIMIT environment variable in Calico.
- `node_memory_limit` (String) Corresponds to the CALICO_NODE_MEMORY_LIMIT environment variable in Calico.
- `typha_cpu_limit` (String) Corresponds to the CALICO_TYPHA_CPU_LIMIT environment variable in Calico.
- `typha_memory_limit` (String) Corresponds to the CALICO_TYPHA_MEMORY_LIMIT environment variable in Calico.


<a id="nestedatt--custom_registry"></a>
### Nested Schema for `custom_registry`

Optional:

- `cert_path` (String)
- `password` (String)
- `repo_path` (String)
- `self_signed_certs` (Boolean)
- `skip_tls` (Boolean)
- `url` (String)
- `username` (String)


<a id="nestedatt--etcd"></a>
### Nested Schema for `etcd`

Optional:

- `data_dir` (String)
- `election_timeout_ms` (Number)
- `heartbeat_interval_ms` (Number)

Read-Only:

- `enable_encryption` (Boolean)
- `version` (String)


<a id="nestedatt--etcd_backup"></a>
### Nested Schema for `etcd_backup`

Optional:

- `daily` (Attributes) (see [below for nested schema](#nestedatt--etcd_backup--daily))
- `interval` (Attributes) (see [below for nested schema](#nestedatt--etcd_backup--interval))
- `storage_local_path` (String) Path on the local filesystem where the etcd backup should be stored. For 'local' storage type only.
- `storage_type` (String) Storage type for the etcd backup. Only 'local' is current supported type. 'local' saves backup to the node's local disk

<a id="nestedatt--etcd_backup--daily"></a>
### Nested Schema for `etcd_backup.daily`

Optional:

- `backup_time` (String) Timestamp for daily backup, specified in format 'HH:MM'
- `max_backups_to_retain` (Number) Maximum number of backups to retain for timestamped backups.


<a id="nestedatt--etcd_backup--interval"></a>
### Nested Schema for `etcd_backup.interval`

Optional:

- `backup_interval` (String) The interval at which etcd backups should be taken, specified in duration strings such as '2h' or '3m'. Note that composite duration strings like '2h3m' are not allowed.
- `max_backups_to_retain` (Number) max number of Backups retention



<a id="nestedatt--k8s_config"></a>
### Nested Schema for `k8s_config`

Optional:

- `api_server_flags` (List of String) List of supported kube-apiserver flags, example: --request-timeout=2m0s,--kubelet-timeout=20s
- `api_server_runtime_config` (String) A set of key=value pairs that enable or disable built-in APIs.
- `controller_manager_flags` (List of String) List of supported controller manager flags, example: --large-cluster-size-threshold=60,--concurrent-statefulset-syncs=10
- `scheduler_flags` (List of String) List of supported scheduler flags, example: --kube-api-burst=120,--log_file_max_size=3000


<a id="nestedatt--cloud_provider"></a>
### Nested Schema for `cloud_provider`

Read-Only:

- `name` (String)
- `type` (String)
- `uuid` (String)


<a id="nestedatt--status"></a>
### Nested Schema for `status`

Read-Only:

- `last_ok` (String)
- `last_op` (String)
- `master_status` (String)
- `status` (String)
- `task_error` (String)
- `task_status` (String)
- `worker_status` (String)

## Import

Import is supported using the following syntax:

```shell
# Use uuid of the cluster to import it into terraform
terraform import pf9_cluster.example d7727229-b2b4-4725-b0a0-473208f5093a
```
